package.path=package.path..";../Samples/ysscripts/lib/?.lua" --;"..package.path
require("utilfunc")

package.path=package.path..";../Samples/ysscripts/samples/?.lua" --;"..package.path
require("useCaseMuscle_gait1956_6steps")


useCases.gait1992_06140c=deepCopyTable(useCases.gait1956_6steps)

useCases.gait1992_06140c.optimizerMethod='Optimizer.methods.CMAes_ys'

useCases.gait1992_06140c.endSegW=10
useCases.gait1992_06140c.prec=.2

useCases.gait1992_06140c.modelName='gait1992_06140c'
useCases.gait1992_06140c.grpName='gait1992_06140c'
useCases.gait1992_06140c.grpNames={'gait1992_06140c'}

useCases.gait1992_06140c.ddqObjWeight=10*(25-7)
useCases.gait1992_06140c.aObjWeight=5000*62
useCases.gait1992_06140c.lambdaObjWeight=.0001
useCases.gait1992_06140c.EEobjWeight=100
useCases.gait1992_06140c.EEobjWeightAngular=10
useCases.gait1992_06140c.momentumWeight=10

-- the initial pendControlParam and pendOptimizationPath can be automatically generated by using createInitialPendControlParam.lua
useCases.gait1992_06140c.pendControlParam=
{
	pendControlParam={['keyframe,0,pendDesiredVel,gait1992_06140c,l,z']=0,['keyframe,0,pendDesiredVel,gait1992_06140c,l,x']=1,['keyframe,0,pendDesiredVel,gait1992_06140c,r,z']=0,['keyframe,0,pendDesiredVel,gait1992_06140c,r,x']=1,['keyframe,0,pendDesiredVel,gait1992_06140c,L1,z']=0,['keyframe,0,pendDesiredVel,gait1992_06140c,L1,x']=1,['keyframe,0,pendDesiredVel,gait1992_06140c,R1,z']=0,['keyframe,0,pendDesiredVel,gait1992_06140c,R1,x']=1,['keyframe,0,pendDesiredVel,gait1992_06140c,L2,z']=0,['keyframe,0,pendDesiredVel,gait1992_06140c,L2,x']=1,['keyframe,0,pendDesiredVel,ignore,0,z']=0,['keyframe,0,pendDesiredVel,ignore,0,x']=1,['keyframe,0,pendDesiredVel,ignore,1,z']=0,['keyframe,0,pendDesiredVel,ignore,1,x']=1,},
['keyframe,0,pendDesiredVel,ignore,0,x']=-0.36616150076566, ['keyframe,0,pendDesiredVel,ignore,0,z']=-0.15438446044817, ['keyframe,0,pendDesiredVel,gait1992_06140c,l,x']=-0.07998295166105, ['keyframe,0,pendDesiredVel,gait1992_06140c,l,z']=-0.19643663042544, ['keyframe,0,pendDesiredVel,gait1992_06140c,r,x']=0.25280102537441, ['keyframe,0,pendDesiredVel,gait1992_06140c,r,z']=-0.063921832104271, ['keyframe,0,pendDesiredVel,gait1992_06140c,L1,x']=0.36124636679804, ['keyframe,0,pendDesiredVel,gait1992_06140c,L1,z']=-0.028816478886632, ['keyframe,0,pendDesiredVel,gait1992_06140c,R1,x']=0.37737444868339, ['keyframe,0,pendDesiredVel,gait1992_06140c,R1,z']=-0.025628943909743, ['keyframe,0,pendDesiredVel,gait1992_06140c,L2,x']=0.30086562929694, ['keyframe,0,pendDesiredVel,gait1992_06140c,L2,z']=-0.014819479614238, ['keyframe,0,pendDesiredVel,ignore,1,x']=0.11485949573601, ['keyframe,0,pendDesiredVel,ignore,1,z']=-0.011689984543935, 
['keyframe,0,pendDesiredVel,ignore,0,x']=-0.36616720928318, ['keyframe,0,pendDesiredVel,ignore,0,z']=-0.15440117535659, ['keyframe,0,pendDesiredVel,gait1992_06140c,l,x']=-0.07999972671331, ['keyframe,0,pendDesiredVel,gait1992_06140c,l,z']=-0.19645833793628, ['keyframe,0,pendDesiredVel,gait1992_06140c,r,x']=0.25278391355663, ['keyframe,0,pendDesiredVel,gait1992_06140c,r,z']=-0.063969685857606, ['keyframe,0,pendDesiredVel,gait1992_06140c,L1,x']=0.36123545535419, ['keyframe,0,pendDesiredVel,gait1992_06140c,L1,z']=-0.028871702773108, ['keyframe,0,pendDesiredVel,gait1992_06140c,R1,x']=0.37735408824242, ['keyframe,0,pendDesiredVel,gait1992_06140c,R1,z']=-0.025627103002031, ['keyframe,0,pendDesiredVel,gait1992_06140c,L2,x']=0.30085799310668, ['keyframe,0,pendDesiredVel,gait1992_06140c,L2,z']=-0.01482640615683, ['keyframe,0,pendDesiredVel,ignore,1,x']=0.11489060669257, ['keyframe,0,pendDesiredVel,ignore,1,z']=-0.01169270532729, 
['keyframe,0,pendDesiredVel,ignore,0,x']=-0.60749789202485, ['keyframe,0,pendDesiredVel,ignore,0,z']=-0.077271163008337, ['keyframe,0,pendDesiredVel,gait1992_06140c,l,x']=-0.035430054899715, ['keyframe,0,pendDesiredVel,gait1992_06140c,l,z']=-0.25832596652401, ['keyframe,0,pendDesiredVel,gait1992_06140c,r,x']=0.35010458892654, ['keyframe,0,pendDesiredVel,gait1992_06140c,r,z']=0.0016779986000168, ['keyframe,0,pendDesiredVel,gait1992_06140c,L1,x']=0.33140260893402, ['keyframe,0,pendDesiredVel,gait1992_06140c,L1,z']=-0.11381873237148, ['keyframe,0,pendDesiredVel,gait1992_06140c,R1,x']=0.30137945094345, ['keyframe,0,pendDesiredVel,gait1992_06140c,R1,z']=0.037746719446306, ['keyframe,0,pendDesiredVel,gait1992_06140c,L2,x']=0.3601563786896, ['keyframe,0,pendDesiredVel,gait1992_06140c,L2,z']=-0.023293432763118, ['keyframe,0,pendDesiredVel,ignore,1,x']=0.12186461089339, ['keyframe,0,pendDesiredVel,ignore,1,z']=-0.014980951352171, 
['keyframe,0,pendDesiredVel,ignore,0,x']=-0.6075480201912, ['keyframe,0,pendDesiredVel,ignore,0,z']=-0.077276841653959, ['keyframe,0,pendDesiredVel,gait1992_06140c,l,x']=-0.035424114421488, ['keyframe,0,pendDesiredVel,gait1992_06140c,l,z']=-0.25839429352683, ['keyframe,0,pendDesiredVel,gait1992_06140c,r,x']=0.35011325215239, ['keyframe,0,pendDesiredVel,gait1992_06140c,r,z']=0.0016619802760742, ['keyframe,0,pendDesiredVel,gait1992_06140c,L1,x']=0.331405223377, ['keyframe,0,pendDesiredVel,gait1992_06140c,L1,z']=-0.11386515940036, ['keyframe,0,pendDesiredVel,gait1992_06140c,R1,x']=0.30139202661728, ['keyframe,0,pendDesiredVel,gait1992_06140c,R1,z']=0.03775155068129, ['keyframe,0,pendDesiredVel,gait1992_06140c,L2,x']=0.3601829906472, ['keyframe,0,pendDesiredVel,gait1992_06140c,L2,z']=-0.023309444803845, ['keyframe,0,pendDesiredVel,ignore,1,x']=0.12186674771038, ['keyframe,0,pendDesiredVel,ignore,1,z']=-0.014982332772392, 
}
useCases.gait1992_06140c.pendOptimizationPath=
{
	firstFrames={1*4,14*4,42*4,70*4,105*4,135*4,167*4,187*4},
	segments={'ignore,0','gait1992_06140c,l','gait1992_06140c,r','gait1992_06140c,L1','gait1992_06140c,R1','gait1992_06140c,L2','ignore,1'},
}
--useCases.gait1992_06140c.measureOptCost=useCases.measureOptCost

useCases.gait1992_06140c.segmentations=
{
	gait1992_06140c={
		firstFrames={1*4,14*4,42*4,70*4,105*4,135*4,167*4,187*4},
		--        (blank)    L    R    L     R     L     (blank)
		names={             'l', 'r', 'L1', 'R1', 'L2',  },
		swingL={             0,   1,   0,    1,    0,    },
		swingR={             1,   0,   1,    0,    1,    },
		footRefL= "convertFromSwingL",
		footRefR= "convertFromSwingR",
		usePositionControl=false,
	},
}
useCases.gait1992_06140c.graphParam=
{
	gait1992_06140c={
		seg={            'l',  'r',  'L1', 'R1','L'},
		num_key={         3,    3,    3  ,  4,  4},
		key_first={       0,    0,    0  ,  0,  0},
		key_last={       'r', 'L1',  'R1', 'L', 'R1'},
	},
}
useCases.gait1992_06140c.graph=
{
	{
		"addInterpolatedSegment",
		grpName="gait1992_06140c",
		name="L",
		seg0={"gait1992_06140c", "L2"},
		seg1={"gait1992_06140c", "L1"},
		startWeight=0, endWeight=1
	},
	{"connectMulti", "gait1992_06140c", "l", "r", "L1", "R1", "L", "R1"},
	--{"initialSegment", "gait1992_06140c", "l"}
	{"initialSegment", "gait1992_06140c", "R1"}
}
useCases.gait1992_06140c.segNames=
{
	"l", "r", "L1", 'R1','L',
}

do 
	useCases.gait1992_06140c.controlParam={
		['useCases,gait1992_06140c,COMobjWeight']=0, 
		['useCases,gait1992_06140c,conservativeW']=1, 
		--['useCases,gait1992_06140c,contactMargin']=0.01, 
		['useCases,gait1992_06140c,dotMomentumScale']=0.3, 
		['useCases,gait1992_06140c,excludeRoot']=true, 
		['useCases,gait1992_06140c,headControlWeight']=0, 
		['useCases,gait1992_06140c,k_d_HEAD']=14, 
		['useCases,gait1992_06140c,k_p_HEAD']=0, 
		['useCases,gait1992_06140c,k_d_EE']=24, 
		['useCases,gait1992_06140c,k_d_momentum']=10, 
		['useCases,gait1992_06140c,k_p_EE']=120, 

		--['useCases,gait1992_06140c,maxPenetratingVel']=0, 
		['useCases,gait1992_06140c,momentumThr']=50, 
		['useCases,gait1992_06140c,noComvelDependentFootAdjustment']=true, 
		['useCases,gait1992_06140c,noIntersectionPrevenction']=true, 
		['useCases,gait1992_06140c,numericalDerivDmot']=true, 
		['useCases,gait1992_06140c,perClassContactMargin']=1, 
		['useCases,gait1992_06140c,turnGain']=10, 
		['useCases,gait1992_06140c,velMarginOffset']=0, 

		['useCases,gait1992_06140c,actuationType']      = useCases.gait1992_06140c.actuationType,
		['useCases,gait1992_06140c,k_p_ID']             = useCases.gait1992_06140c.k_p_ID,
		['useCases,gait1992_06140c,k_d_ID']             = useCases.gait1992_06140c.k_d_ID,
		['useCases,gait1992_06140c,ddqObjWeight']       = useCases.gait1992_06140c.ddqObjWeight,
		['useCases,gait1992_06140c,tauObjWeight']       = useCases.gait1992_06140c.tauObjWeight,
		['useCases,gait1992_06140c,ftObjWeight']        = useCases.gait1992_06140c.ftObjWeight,
		['useCases,gait1992_06140c,aObjWeight']         = useCases.gait1992_06140c.aObjWeight,
		['useCases,gait1992_06140c,lambdaObjWeight']    = useCases.gait1992_06140c.lambdaObjWeight,
		['useCases,gait1992_06140c,EEobjWeight']        = useCases.gait1992_06140c.EEobjWeight,
		['useCases,gait1992_06140c,EEobjWeightAngular'] = useCases.gait1992_06140c.EEobjWeightAngular,
		['useCases,gait1992_06140c,momentumWeight']     = useCases.gait1992_06140c.momentumWeight,
		['useCases,gait1992_06140c,tauMax']             = useCases.gait1992_06140c.tauMax,
		['useCases,gait1992_06140c,ftMax']              = useCases.gait1992_06140c.ftMax,
	}

	local function accumulate(cp_mod)
		local useCase=useCases.gait1992_06140c
		useCases.accumulate(useCase, cp_mod)
	end

	accumulate({
		----['keyframe,0,footRmod,gait1992_06140c,l,y']  = 0.,
		--['keyframe,1,footRmod,gait1992_06140c,l,y']  = 0.05,
		--['keyframe,0,footLmod,gait1992_06140c,r,y']  = 0.05,
		--['keyframe,1,footLmod,gait1992_06140c,r,y']  = 0.1,
		--['keyframe,0,footRmod,gait1992_06140c,L1,y'] = 0.0,
		--['keyframe,1,footRmod,gait1992_06140c,L1,y'] = 0.1,
		--['map,0,swingFootMod,gait1992_06140c,y']     = 0.1,
		--['map,1,swingFootMod,gait1992_06140c,y']     = 0.3,
		--['map,2,swingFootMod,gait1992_06140c,y']     = 0.2,

		------['keyframe,0,footLmod,gait1992_06140c,l,y']  = 0.,
		------['keyframe,1,footLmod,gait1992_06140c,l,y']  = 0.,
		----['keyframe,0,footRmod,gait1992_06140c,r,y']  = 0.,
		----['keyframe,1,footRmod,gait1992_06140c,r,y']  = -.1,
		----['keyframe,0,footLmod,gait1992_06140c,L1,y'] = 0.,
		----['keyframe,1,footLmod,gait1992_06140c,L1,y'] = -.1,
		----['map,0,spprtFootMod,gait1992_06140c,y']     = 0.,
		----['map,1,spprtFootMod,gait1992_06140c,y']     = 0.,
		----['map,2,spprtFootMod,gait1992_06140c,y']     = 0.,
	})
	useCases.unmapControlParam(useCases.gait1992_06140c)


-------------------------------------------------

accumulate({['map,0,swingFootMod,gait1992_06140c,x']= -0.25880214898868, ['map,0,swingFootMod,gait1992_06140c,y']= 0.76149455626524, ['map,0,swingFootMod,gait1992_06140c,z']= 0.51237076450041, ['map,1,swingFootMod,gait1992_06140c,x']= -0.89673477296205, ['map,1,swingFootMod,gait1992_06140c,y']= -0.11215834232368, ['map,1,swingFootMod,gait1992_06140c,z']= -0.57661110867132, ['map,2,swingFootMod,gait1992_06140c,x']= -0.3026142548176, ['map,2,swingFootMod,gait1992_06140c,y']= -0.81202584156455, ['map,2,swingFootMod,gait1992_06140c,z']= -0.59355689417687, ['map,0,spprtFootMod,gait1992_06140c,x']= -0.2241244205583, ['map,0,spprtFootMod,gait1992_06140c,y']= -0.22166168865309, ['map,0,spprtFootMod,gait1992_06140c,z']= -0.55017791531975, ['map,1,spprtFootMod,gait1992_06140c,x']= -0.20717070696094, ['map,1,spprtFootMod,gait1992_06140c,y']= -0.30112002370929, ['map,1,spprtFootMod,gait1992_06140c,z']= -0.074769742812903, ['map,2,spprtFootMod,gait1992_06140c,x']= -0.096787985834569, ['map,2,spprtFootMod,gait1992_06140c,y']= -0.47511159060618, ['map,2,spprtFootMod,gait1992_06140c,z']= -0.57972808842035, })


useCases.unmapControlParam(useCases.gait1992_06140c)
end


